<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>健康自测中心 - 专业健康评估工具 | AZ Ring智能健康戒指</title>
    <meta name="description" content="专业的健康自测中心，提供多种科学的健康评估工具。包含中医九种体质测试等专业评估，帮助您了解身体状况。">
    
    <!-- DNS预解析和preconnect优化 -->
    <link rel="dns-prefetch" href="//cdn.staticfile.org">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdn.staticfile.org">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    
    <!-- 样式文件 -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.0.0/css/all.min.css">
    
    <!-- 健康数据管理系统 -->
    <script src="js/health-data-manager.js"></script>
    
    <!-- 本地Inter字体 -->
    <style>
        @font-face {
            font-family: 'Inter';
            font-style: normal;
            font-weight: 300 700;
            font-display: swap;
            src: url('../fonts/inter-variable.woff2') format('woff2');
        }
        
        :root {
            --oura-black: #0a0a0a;
            --oura-dark: #1a1a1a;
            --oura-gray: #2a2a2a;
            --oura-light-gray: #666666;
            --oura-white: #ffffff;
            --oura-accent: #ff6b35;
            --oura-accent-light: #ff8a65;
            --oura-blue: #4a90e2;
            --oura-green: #7ed321;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--oura-black) 0%, var(--oura-dark) 100%);
            color: var(--oura-white);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* 导航栏样式 */
        .oura-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            padding: 0;
        }
        
        .oura-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        .oura-nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 80px;
        }
        
        .oura-logo img {
            height: 40px;
            width: auto;
        }
        
        .oura-nav-links {
            display: flex;
            list-style: none;
            gap: 32px;
        }
        
        .oura-nav-link {
            color: var(--oura-light-gray);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
        }
        
        .oura-nav-link:hover,
        .oura-nav-link.active {
            color: var(--oura-white);
        }
        
        .oura-nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--oura-accent);
        }
        
        .language-switcher {
            display: flex;
            gap: 8px;
        }
        
        .lang-btn {
            background: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--oura-light-gray);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .lang-btn.active,
        .lang-btn:hover {
            border-color: var(--oura-accent);
            color: var(--oura-accent);
        }
        
        .oura-mobile-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--oura-white);
            font-size: 20px;
            cursor: pointer;
        }
        
        .oura-mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--oura-dark);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px 24px;
            flex-direction: column;
            gap: 16px;
        }
        
        .oura-mobile-menu.active {
            display: flex;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 120px 24px 60px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 80px;
        }
        
        .title {
            font-size: 48px;
            font-weight: 300;
            margin-bottom: 24px;
            background: linear-gradient(135deg, var(--oura-accent) 0%, var(--oura-accent-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            color: var(--oura-light-gray);
            font-size: 20px;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto 40px;
        }
        
        .highlight-text {
            color: var(--oura-accent);
            font-weight: 600;
        }
        
        /* 测试类型选择样式 */
        .test-types-section {
            margin: 60px 0;
        }
        
        .section-title {
            font-size: 32px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 16px;
            color: var(--oura-white);
        }
        
        .section-subtitle {
            font-size: 18px;
            color: var(--oura-light-gray);
            text-align: center;
            margin-bottom: 60px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .test-types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 40px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .test-type-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 24px;
            padding: 32px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: inherit;
            display: block;
        }
        
        .test-type-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--oura-accent);
        }
        
        .test-type-card.coming-soon {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .test-type-card.coming-soon:hover {
            transform: none;
            box-shadow: none;
            border-color: rgba(255, 255, 255, 0.1);
        }
        
        .test-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .test-card-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 107, 53, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .test-card-icon i {
            font-size: 24px;
            color: var(--oura-accent);
        }
        
        .test-card-badge {
            background: var(--oura-accent);
            color: var(--oura-white);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .coming-soon-badge {
            background: var(--oura-light-gray);
            color: var(--oura-dark);
        }
        
        .test-card-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--oura-white);
            margin-bottom: 16px;
        }
        
        .test-card-description {
            color: var(--oura-light-gray);
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 24px;
        }
        
        .test-card-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 24px;
        }
        
        .feature-tag {
            background: rgba(255, 107, 53, 0.2);
            color: var(--oura-accent);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .feature-tag.disabled {
            background: rgba(255, 255, 255, 0.1);
            color: var(--oura-light-gray);
        }
        
        .test-card-stats {
            display: flex;
            gap: 24px;
            margin-bottom: 24px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--oura-light-gray);
            font-size: 14px;
        }
        
        .stat-item i {
            color: var(--oura-accent);
        }
        
        .test-card-cta {
            color: var(--oura-accent);
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .test-card-cta i {
            margin-left: 8px;
            transition: transform 0.3s ease;
        }
        
        .test-type-card:hover .test-card-cta i {
            transform: translateX(4px);
        }
        
        .test-card-cta.disabled {
            background: rgba(255, 255, 255, 0.05);
            color: var(--oura-light-gray);
        }
        
        .assessment-card {
            border-radius: 24px;
            padding: 48px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: inherit;
        }
        
        .assessment-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
        }
        
        .assessment-card:hover .card-decoration {
            transform: scale(1.3);
            opacity: 0.9;
        }
        
        .quick-assessment {
            background: linear-gradient(135deg, #7ed321 0%, #a4de6c 100%);
        }
        
        .standard-assessment {
            background: linear-gradient(135deg, var(--oura-accent) 0%, var(--oura-accent-light) 100%);
        }
        
        .deep-assessment {
            background: linear-gradient(135deg, var(--oura-blue) 0%, #6ba3f5 100%);
        }
        
        .card-icon {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 32px;
        }
        
        .card-icon i {
            font-size: 32px;
            color: var(--oura-white);
        }
        
        .card-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--oura-white);
            margin-bottom: 16px;
        }
        
        .card-description {
            color: rgba(255, 255, 255, 0.9);
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 32px;
        }
        
        .card-meta {
            display: flex;
            gap: 24px;
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 32px;
        }
        
        .card-meta span {
            display: flex;
            align-items: center;
        }
        
        .card-meta i {
            margin-right: 8px;
        }
        
        .card-cta {
            color: var(--oura-white);
            font-weight: 600;
            font-size: 18px;
            display: flex;
            align-items: center;
        }
        
        .card-cta i {
            margin-left: 12px;
            transition: transform 0.3s ease;
        }
        
        .assessment-card:hover .card-cta i {
            transform: translateX(4px);
        }
        
        .card-decoration {
            position: absolute;
            top: -30px;
            right: -30px;
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            opacity: 0.6;
            transition: all 0.3s ease;
        }
        
        .features-section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 24px;
            padding: 60px 48px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .features-title {
            text-align: center;
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 48px;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 48px;
        }
        
        .feature-item {
            text-align: center;
        }
        
        .feature-icon {
            font-size: 48px;
            color: var(--oura-accent);
            margin-bottom: 24px;
        }
        
        .feature-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--oura-white);
            margin-bottom: 16px;
        }
        
        .feature-description {
            color: var(--oura-light-gray);
            line-height: 1.6;
        }
        
        .tcm-intro {
            background: rgba(255, 107, 53, 0.05);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255, 107, 53, 0.2);
            margin: 60px 0;
        }
        
        .tcm-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--oura-accent);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .tcm-title i {
            margin-right: 12px;
        }
        
        .tcm-content {
            color: var(--oura-light-gray);
            line-height: 1.7;
            font-size: 16px;
        }
        
        @media (max-width: 768px) {
            .oura-nav-links,
            .language-switcher {
                display: none;
            }
            
            .oura-mobile-toggle {
                display: block;
            }
            
            .container {
                padding: 100px 16px 40px;
            }
            
            .title {
                font-size: 36px;
            }
            
            .subtitle {
                font-size: 18px;
            }
            
            .section-title {
                font-size: 28px;
            }
            
            .section-subtitle {
                font-size: 16px;
                margin-bottom: 40px;
            }
            
            .test-types-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
            
            .test-type-card {
                padding: 24px;
            }
            
            .test-card-title {
                font-size: 20px;
            }
            
            .test-card-description {
                font-size: 14px;
            }
            
            .test-card-stats {
                flex-direction: column;
                gap: 12px;
            }
        }

        /* ========== 健康仪表板样式 ========== */
        .health-dashboard {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 60px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dashboard-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--oura-white);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dashboard-close {
            background: none;
            border: none;
            color: var(--oura-light-gray);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            padding: 8px;
        }

        .dashboard-close:hover {
            color: var(--oura-accent);
            transform: rotate(90deg);
        }

        .dashboard-content {
            display: grid;
            gap: 32px;
        }

        /* 综合健康评分卡片 */
        .health-score-card {
            background: linear-gradient(135deg, var(--oura-accent) 0%, var(--oura-accent-light) 100%);
            border-radius: 20px;
            padding: 32px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .health-score-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .score-label {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 12px;
        }

        .score-value {
            font-size: 72px;
            font-weight: 700;
            color: var(--oura-white);
            line-height: 1;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        .score-trend {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        /* 各项指标 */
        .health-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .metric-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
            cursor: pointer;
        }

        .metric-item:hover {
            transform: translateY(-4px);
            border-color: var(--oura-accent);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .metric-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .metric-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .metric-name {
            font-size: 14px;
            color: var(--oura-light-gray);
        }

        .metric-score {
            font-size: 24px;
            font-weight: 600;
            color: var(--oura-white);
        }

        .metric-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .metric-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--oura-accent), var(--oura-accent-light));
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        /* 测试统计 */
        .test-statistics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 600;
            color: var(--oura-white);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--oura-light-gray);
        }

        /* 健康建议 */
        .health-recommendations {
            background: rgba(255, 107, 53, 0.1);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid rgba(255, 107, 53, 0.3);
        }

        .health-recommendations h3 {
            font-size: 18px;
            color: var(--oura-accent);
            margin-bottom: 16px;
        }

        .recommendation-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .recommendation-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid var(--oura-accent);
        }

        .recommendation-text {
            color: var(--oura-light-gray);
            line-height: 1.6;
        }

        /* ========== 浮动按钮优化样式 ========== */
        .floating-actions {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 999;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* 永久文字标签 */
        .fab-label-permanent {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            color: var(--oura-dark);
            padding: 10px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
            white-space: nowrap;
            opacity: 0;
            animation: fadeInLabel 0.5s ease 0.5s forwards;
            pointer-events: none;
        }

        @keyframes fadeInLabel {
            from { opacity: 0; transform: translateX(10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .fab-main {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--oura-accent), var(--oura-accent-light));
            border: none;
            color: var(--oura-white);
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(255, 107, 53, 0.4);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* 脉冲动画（有数据时） */
        .fab-main.has-data {
            animation: pulse-fab 2s ease-in-out infinite;
        }

        @keyframes pulse-fab {
            0%, 100% {
                box-shadow: 0 4px 20px rgba(255, 107, 53, 0.4);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 30px rgba(255, 107, 53, 0.8);
                transform: scale(1.05);
            }
        }

        .fab-main:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(255, 107, 53, 0.6);
            animation: none;
        }

        /* Tooltip提示 */
        .fab-tooltip {
            position: absolute;
            bottom: 70px;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            pointer-events: none;
        }

        .fab-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            right: 20px;
            border: 6px solid transparent;
            border-top-color: rgba(0, 0, 0, 0.9);
        }

        .fab-main:hover .fab-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(-5px);
        }

        .fab-menu {
            position: absolute;
            bottom: 80px;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 12px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: all 0.3s;
        }

        .fab-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .fab-item {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--oura-dark);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--oura-white);
            padding: 12px 20px;
            border-radius: 24px;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 14px;
        }

        .fab-item:hover {
            background: var(--oura-accent);
            border-color: var(--oura-accent);
            transform: translateX(-4px);
        }

        .fab-item i {
            font-size: 16px;
        }

        /* ========== 弹窗样式 ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--oura-dark);
            border-radius: 24px;
            max-width: 900px;
            max-height: 90vh;
            width: 90%;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 32px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header h2 {
            font-size: 24px;
            color: var(--oura-white);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--oura-light-gray);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            padding: 8px;
        }

        .modal-close:hover {
            color: var(--oura-accent);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 32px;
            overflow-y: auto;
            max-height: calc(90vh - 100px);
        }

        /* 历史记录筛选器 */
        .history-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--oura-light-gray);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .filter-btn:hover {
            border-color: var(--oura-accent);
            color: var(--oura-white);
        }

        .filter-btn.active {
            background: var(--oura-accent);
            border-color: var(--oura-accent);
            color: var(--oura-white);
        }

        /* 历史时间轴 */
        .history-timeline {
            position: relative;
            padding-left: 40px;
        }

        .history-timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, var(--oura-accent), transparent);
        }

        .history-item {
            position: relative;
            margin-bottom: 32px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }

        .history-item:hover {
            border-color: var(--oura-accent);
            transform: translateX(4px);
        }

        .history-item::before {
            content: '';
            position: absolute;
            left: -28px;
            top: 28px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--oura-accent);
            border: 3px solid var(--oura-dark);
        }

        .history-date {
            font-size: 12px;
            color: var(--oura-light-gray);
            margin-bottom: 8px;
        }

        .history-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--oura-white);
            margin-bottom: 8px;
        }

        .history-score {
            font-size: 32px;
            font-weight: 700;
            color: var(--oura-accent);
            margin-bottom: 8px;
        }

        .history-level {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            background: rgba(255, 107, 53, 0.2);
            color: var(--oura-accent);
        }

        /* 空状态 */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--oura-light-gray);
        }

        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state p {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .empty-hint {
            font-size: 14px;
            opacity: 0.7;
        }

        /* 数据说明弹窗 */
        .info-section {
            margin-bottom: 32px;
        }

        .info-section h3 {
            font-size: 18px;
            color: var(--oura-white);
            margin-bottom: 12px;
        }

        .info-section p {
            color: var(--oura-light-gray);
            line-height: 1.6;
        }

        .info-section ul {
            color: var(--oura-light-gray);
            line-height: 1.8;
            padding-left: 20px;
        }

        .user-id-display {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 16px;
            border-radius: 8px;
            margin-top: 12px;
        }

        .user-id-display code {
            flex: 1;
            color: var(--oura-accent);
            font-family: monospace;
            font-size: 14px;
        }

        .copy-btn {
            background: var(--oura-accent);
            border: none;
            color: var(--oura-white);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }

        .copy-btn:hover {
            background: var(--oura-accent-light);
        }

        .user-id-hint {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 8px;
        }

        .danger-zone {
            border-top: 1px solid rgba(255, 0, 0, 0.3);
            padding-top: 24px;
            margin-top: 32px;
        }

        .danger-zone h3 {
            color: #ff4444;
            font-size: 16px;
            margin-bottom: 16px;
        }

        .btn-danger {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
            color: #ff4444;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-danger:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff4444;
        }

        /* 首次引导蒙层 */
        .fab-guide-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.4s ease;
        }

        .fab-guide-overlay.active {
            display: flex;
        }

        /* 引导内容 */
        .fab-guide-content {
            position: relative;
            text-align: center;
            max-width: 400px;
            padding: 40px;
            animation: slideUpGuide 0.5s ease;
        }

        @keyframes slideUpGuide {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fab-guide-icon {
            font-size: 64px;
            margin-bottom: 24px;
            animation: bounceGuide 1s ease infinite;
        }

        @keyframes bounceGuide {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .fab-guide-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--oura-white);
            margin-bottom: 16px;
        }

        .fab-guide-desc {
            font-size: 16px;
            color: var(--oura-light-gray);
            line-height: 1.6;
            margin-bottom: 32px;
        }

        /* 引导箭头指向浮动按钮 */
        .fab-guide-arrow {
            position: fixed;
            bottom: 120px;
            right: 60px;
            font-size: 48px;
            color: var(--oura-accent);
            animation: pointDown 1s ease infinite;
            z-index: 10001;
        }

        @keyframes pointDown {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }

        /* 引导按钮 */
        .fab-guide-btn {
            background: linear-gradient(135deg, var(--oura-accent), var(--oura-accent-light));
            border: none;
            color: var(--oura-white);
            padding: 14px 32px;
            border-radius: 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.3);
        }

        .fab-guide-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(255, 107, 53, 0.4);
        }

        /* 高亮浮动按钮区域 */
        .fab-highlight-zone {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 180px;
            height: 80px;
            border-radius: 40px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            z-index: 9999;
            pointer-events: none;
            animation: pulse-highlight 2s ease-in-out infinite;
        }

        @keyframes pulse-highlight {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        /* 响应式适配 */
        @media (max-width: 768px) {
            .health-dashboard {
                padding: 24px 16px;
            }
            
            .health-metrics {
                grid-template-columns: 1fr;
            }
            
            .test-statistics {
                grid-template-columns: 1fr;
            }
            
            .floating-actions {
                bottom: 20px;
                right: 20px;
            }
            
            .fab-main {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .fab-label-permanent {
                display: none;
            }
            
            .fab-guide-arrow {
                bottom: 100px;
                right: 25px;
            }
            
            .fab-guide-content {
                padding: 24px;
                max-width: 90%;
            }
            
            .fab-guide-title {
                font-size: 20px;
            }
            
            .fab-guide-desc {
                font-size: 14px;
            }
            
            .modal-content {
                width: 95%;
                max-height: 95vh;
            }
            
            .modal-body {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="oura-nav">
        <div class="oura-container">
            <div class="oura-nav-content">
                <a href="../index.html" class="oura-logo">
                    <img src="../产品资料与图片/logo.png" alt="深圳佰屹创新">
                </a>
                
                <ul class="oura-nav-links">
                    <li><a href="../index.html" class="oura-nav-link" data-zh="首页" data-en="Home">首页</a></li>
                    <li><a href="../index.html#products" class="oura-nav-link" data-zh="产品" data-en="Products">产品</a></li>
                    <li><a href="index.html" class="oura-nav-link" data-zh="技术博客" data-en="Tech Blog">技术博客</a></li>
                    <li><a href="health-assessment.html" class="oura-nav-link active" data-zh="健康自测" data-en="Health Assessment">健康自测</a></li>
                    <li><a href="../index.html#about" class="oura-nav-link" data-zh="关于" data-en="About">关于</a></li>
                    <li><a href="../index.html#contact" class="oura-nav-link" data-zh="联系" data-en="Contact">联系</a></li>
                </ul>
                
                <div class="language-switcher">
                    <button class="lang-btn active" onclick="switchLanguage('zh')">中文</button>
                    <button class="lang-btn" onclick="switchLanguage('en')">English</button>
                </div>
                
                <button class="oura-mobile-toggle" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <div class="oura-mobile-menu" id="mobile-menu">
                <a href="../index.html" class="oura-nav-link" data-zh="首页" data-en="Home">首页</a>
                <a href="../index.html#products" class="oura-nav-link" data-zh="产品" data-en="Products">产品</a>
                <a href="index.html" class="oura-nav-link" data-zh="技术博客" data-en="Tech Blog">技术博客</a>
                <a href="health-assessment.html" class="oura-nav-link active" data-zh="健康自测" data-en="Health Assessment">健康自测</a>
                <a href="../index.html#about" class="oura-nav-link" data-zh="关于" data-en="About">关于</a>
                <a href="../index.html#contact" class="oura-nav-link" data-zh="联系" data-en="Contact">联系</a>
                <div class="mobile-lang-switcher" style="padding: 12px 0; border-top: 1px solid rgba(255,255,255,0.1); margin-top: 12px;">
                    <button class="lang-btn active" onclick="switchLanguage('zh')">中文</button>
                    <button class="lang-btn" onclick="switchLanguage('en')">English</button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="header">
            <h1 class="title">健康自测中心</h1>
            <p class="subtitle">
                专业的健康评估工具集合，提供多种科学的健康自测方式。
                通过专业的<span class="highlight-text">健康分析</span>，帮助您更好地了解和管理自己的身体状况。
            </p>
        </div>

        <!-- 个人健康仪表板 -->
        <div class="health-dashboard" id="healthDashboard" style="display: none;">
            <div class="dashboard-header">
                <h2 class="dashboard-title">
                    <i class="fas fa-chart-line"></i>
                    我的健康总览
                </h2>
                <button class="dashboard-close" onclick="toggleDashboard()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="dashboard-content">
                <!-- 综合健康评分 -->
                <div class="health-score-card">
                    <div class="score-label">综合健康评分</div>
                    <div class="score-value" id="overallScore">--</div>
                    <div class="score-trend" id="scoreTrend">
                        <i class="fas fa-arrow-up"></i>
                        <span>较上次 +0</span>
                    </div>
                </div>
                
                <!-- 各项指标 -->
                <div class="health-metrics">
                    <div class="metric-item" data-type="sleep">
                        <div class="metric-icon">😴</div>
                        <div class="metric-info">
                            <div class="metric-name">睡眠质量</div>
                            <div class="metric-score" id="sleepScore">--</div>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-bar-fill" id="sleepBar" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="metric-item" data-type="cardiovascular">
                        <div class="metric-icon">❤️</div>
                        <div class="metric-info">
                            <div class="metric-name">心血管健康</div>
                            <div class="metric-score" id="cardiovascularScore">--</div>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-bar-fill" id="cardiovascularBar" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="metric-item" data-type="stress">
                        <div class="metric-icon">🧠</div>
                        <div class="metric-info">
                            <div class="metric-name">压力水平</div>
                            <div class="metric-score" id="stressScore">--</div>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-bar-fill" id="stressBar" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="metric-item" data-type="tcm">
                        <div class="metric-icon">☯️</div>
                        <div class="metric-info">
                            <div class="metric-name">中医体质</div>
                            <div class="metric-score" id="tcmScore">--</div>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-bar-fill" id="tcmBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 测试统计 -->
                <div class="test-statistics">
                    <div class="stat-box">
                        <div class="stat-icon">📝</div>
                        <div class="stat-value" id="totalTests">0</div>
                        <div class="stat-label">总测试次数</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-icon">📅</div>
                        <div class="stat-value" id="lastTestDate">--</div>
                        <div class="stat-label">最近测试</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-icon">🎯</div>
                        <div class="stat-value" id="completionRate">0%</div>
                        <div class="stat-label">完成度</div>
                    </div>
                </div>
                
                <!-- 健康建议 -->
                <div class="health-recommendations" id="healthRecommendations">
                    <h3>💡 智能建议</h3>
                    <div class="recommendation-list" id="recommendationList">
                        <!-- 动态生成建议 -->
                    </div>
                </div>
            </div>
        </div>

        <div class="test-types-section">
            <h2 class="section-title">选择适合您的健康评估</h2>
            <p class="section-subtitle">我们提供多种专业的健康评估工具，请选择您感兴趣的测试类型</p>
            
            <div class="test-types-grid">
                <!-- 中医九种体质测试 -->
                <a href="health-tcm-constitution.html" class="test-type-card tcm-constitution">
                    <div class="test-card-header">
                        <div class="test-card-icon">
                            <i class="fas fa-yin-yang"></i>
                        </div>
                        <div class="test-card-badge">推荐</div>
                    </div>
                    <h3 class="test-card-title">中医九种体质测试</h3>
                    <p class="test-card-description">
                        基于传统中医体质学理论，通过专业问卷分析您的体质类型。
                        包含平和质、气虚质、阳虚质等九种体质分类，提供个性化调理建议。
                    </p>
                    <div class="test-card-features">
                        <span class="feature-tag">科学专业</span>
                        <span class="feature-tag">个性化</span>
                        <span class="feature-tag">调理建议</span>
                    </div>
                    <div class="test-card-stats">
                        <div class="stat-item">
                            <i class="fas fa-users"></i>
                            <span>10万+ 用户</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-star"></i>
                            <span>4.8分 评价</span>
                        </div>
                    </div>
                    <div class="test-card-cta">
                        开始测试 <i class="fas fa-arrow-right"></i>
                    </div>
                </a>

                <!-- 睡眠质量评估 -->
                <a href="health-sleep-center.html" class="test-type-card sleep-assessment">
                    <div class="test-card-header">
                        <div class="test-card-icon">
                            <i class="fas fa-moon"></i>
                        </div>
                        <div class="test-card-badge">科学</div>
                    </div>
                    <h3 class="test-card-title">睡眠质量评估</h3>
                    <p class="test-card-description">
                        基于匹兹堡睡眠质量指数（PSQI）国际权威标准，科学评估您的睡眠质量。
                        PSQI是全球临床广泛应用的睡眠评估工具，从主观睡眠质量、入睡时间、睡眠时长、日间功能等多维度进行专业分析。
                    </p>
                    <div class="test-card-features">
                        <span class="feature-tag">PSQI标准</span>
                        <span class="feature-tag">国际权威</span>
                        <span class="feature-tag">临床应用</span>
                    </div>
                    <div class="test-card-stats">
                        <div class="stat-item">
                            <i class="fas fa-certificate"></i>
                            <span>PSQI权威</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-hospital"></i>
                            <span>临床标准</span>
                        </div>
                    </div>
                    <div class="test-card-cta">
                        开始测试 <i class="fas fa-arrow-right"></i>
                    </div>
                </a>

                <!-- 压力与情绪健康测试 -->
                <a href="health-stress-emotion.html" class="test-type-card stress-emotion">
                    <div class="test-card-header">
                        <div class="test-card-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="test-card-badge">新上线</div>
                    </div>
                    <h3 class="test-card-title">压力与情绪健康测试</h3>
                    <p class="test-card-description">
                        基于国际权威压力感知量表（PSS），科学评估您的压力水平和情绪状态。
                        提供快速筛查、标准评估、深度剖析三种方式，AI智能分析，生成个性化改善方案。
                    </p>
                    <div class="test-card-features">
                        <span class="feature-tag">科学权威</span>
                        <span class="feature-tag">AI分析</span>
                        <span class="feature-tag">个性化</span>
                    </div>
                    <div class="test-card-stats">
                        <div class="stat-item">
                            <i class="fas fa-robot"></i>
                            <span>AI智能</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-certificate"></i>
                            <span>PSS标准</span>
                        </div>
                    </div>
                    <div class="test-card-cta">
                        开始测试 <i class="fas fa-arrow-right"></i>
                    </div>
                </a>

                <!-- 心血管健康风险评估 -->
                <a href="health-cardiovascular-center.html" class="test-type-card cardiovascular-assessment">
                    <div class="test-card-header">
                        <div class="test-card-icon">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="test-card-badge">新上线</div>
                    </div>
                    <h3 class="test-card-title">心血管健康风险评估</h3>
                    <p class="test-card-description">
                        基于Framingham国际权威标准，科学预测您的10年心血管疾病风险。
                        Framingham心脏研究历经70年，是全球公认的心血管风险评估金标准，提供快速评估和标准评估两种模式。
                    </p>
                    <div class="test-card-features">
                        <span class="feature-tag">Framingham标准</span>
                        <span class="feature-tag">70年验证</span>
                        <span class="feature-tag">AI分析</span>
                    </div>
                    <div class="test-card-stats">
                        <div class="stat-item">
                            <i class="fas fa-certificate"></i>
                            <span>国际金标准</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-hospital"></i>
                            <span>临床应用</span>
                        </div>
                    </div>
                    <div class="test-card-cta">
                        开始测试 <i class="fas fa-arrow-right"></i>
                    </div>
                </a>
            </div>
        </div>
        
    </div>

    <script>
        // ========== 健康数据管理类 ==========
        // 注意：HealthDataManager 现在由 js/health-data-manager.js 提供
        // 以下是旧版本的类定义，已被注释掉
        /*
        class HealthDataManager {
            constructor() {
                this.userId = this.getOrCreateUserId();
                this.init();
            }
            
            // 初始化
            init() {
                console.log('💊 健康数据管理系统已初始化');
                console.log('👤 用户ID:', this.userId);
                this.checkAndShowDashboard();
                this.updateFabState();
            }
            
            // 获取或创建用户ID
            getOrCreateUserId() {
                let userId = localStorage.getItem('health_user_id');
                if (!userId) {
                    userId = this.generateUUID();
                    localStorage.setItem('health_user_id', userId);
                    console.log('✨ 新用户ID已创建');
                }
                return userId;
            }
            
            // 生成UUID
            generateUUID() {
                return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    const r = Math.random() * 16 | 0;
                    const v = c === 'x' ? r : (r & 0x3 | 0x8);
                    return v.toString(16);
                });
            }
            
            // 保存测试结果
            saveTestResult(testType, testName, score, level, details = {}) {
                const record = {
                    id: Date.now(),
                    testType: testType,
                    testName: testName,
                    score: score,
                    level: level,
                    date: new Date().toISOString().split('T')[0],
                    timestamp: Date.now(),
                    details: details
                };
                
                const history = this.getHistory();
                const isFirstTest = history.length === 0;
                
                history.push(record);
                localStorage.setItem('health_history', JSON.stringify(history));
                
                console.log('✅ 测试结果已保存:', record);
                
                // 更新浮动按钮状态
                this.updateFabState();
                
                // 首次测试显示引导
                if (isFirstTest) {
                    setTimeout(() => {
                        showFabGuide();
                    }, 500);
                }
                
                return record;
            }
            
            // 获取历史记录
            getHistory(testType = null) {
                const history = JSON.parse(localStorage.getItem('health_history') || '[]');
                return testType ? history.filter(h => h.testType === testType) : history;
            }
            
            // 获取最新记录
            getLatestRecord(testType) {
                const records = this.getHistory(testType);
                return records.length > 0 ? records[records.length - 1] : null;
            }
            
            // 获取统计信息
            getStatistics() {
                const history = this.getHistory();
                const sleepRecords = history.filter(h => h.testType === 'sleep');
                const cardiovascularRecords = history.filter(h => h.testType === 'cardiovascular');
                const stressRecords = history.filter(h => h.testType === 'stress');
                const tcmRecords = history.filter(h => h.testType === 'tcm');
                
                return {
                    totalTests: history.length,
                    sleepCount: sleepRecords.length,
                    cardiovascularCount: cardiovascularRecords.length,
                    stressCount: stressRecords.length,
                    tcmCount: tcmRecords.length,
                    lastTestDate: history.length > 0 ? history[history.length - 1].date : null,
                    completionRate: Math.round((new Set(history.map(h => h.testType)).size / 4) * 100)
                };
            }
            
            // 计算综合健康评分
            calculateOverallScore() {
                const latest = {
                    sleep: this.getLatestRecord('sleep'),
                    cardiovascular: this.getLatestRecord('cardiovascular'),
                    stress: this.getLatestRecord('stress'),
                    tcm: this.getLatestRecord('tcm')
                };
                
                const scores = [];
                if (latest.sleep) scores.push(latest.sleep.score);
                if (latest.cardiovascular) scores.push(latest.cardiovascular.score);
                if (latest.stress) scores.push(100 - latest.stress.score); // 压力越高分数越低
                if (latest.tcm) scores.push(latest.tcm.score);
                
                if (scores.length === 0) return 0;
                return Math.round(scores.reduce((a, b) => a + b, 0) / scores.length);
            }
            
            // 生成健康建议
            generateRecommendations() {
                const recommendations = [];
                const latest = {
                    sleep: this.getLatestRecord('sleep'),
                    cardiovascular: this.getLatestRecord('cardiovascular'),
                    stress: this.getLatestRecord('stress'),
                    tcm: this.getLatestRecord('tcm')
                };
                
                if (latest.sleep && latest.sleep.score < 70) {
                    recommendations.push('您的睡眠质量需要改善，建议每晚保持7-8小时睡眠，睡前避免使用电子设备。');
                }
                
                if (latest.cardiovascular && latest.cardiovascular.score < 60) {
                    recommendations.push('心血管风险偏高，建议增加有氧运动，控制饮食，定期体检。');
                }
                
                if (latest.stress && latest.stress.score > 60) {
                    recommendations.push('压力水平较高，建议尝试冥想、瑜伽等放松方式，保持规律作息。');
                }
                
                if (!latest.sleep || !latest.cardiovascular || !latest.stress || !latest.tcm) {
                    recommendations.push('建议完成所有测试类型，以获得更全面的健康评估。');
                }
                
                if (recommendations.length === 0) {
                    recommendations.push('您的健康状况良好！继续保持健康的生活方式。');
                }
                
                return recommendations;
            }
            
            // 导出数据
            exportData() {
                const data = {
                    version: '1.0',
                    userId: this.userId,
                    exportDate: new Date().toISOString(),
                    history: this.getHistory(),
                    settings: JSON.parse(localStorage.getItem('health_settings') || '{}')
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `health_data_${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                alert('✅ 健康数据已导出！');
            }
            
            // 导入数据
            importData(jsonData) {
                try {
                    const data = JSON.parse(jsonData);
                    
                    if (!data.userId || !data.history) {
                        throw new Error('数据格式错误');
                    }
                    
                    if (confirm('导入数据会覆盖当前所有记录，是否继续？')) {
                        localStorage.setItem('health_user_id', data.userId);
                        localStorage.setItem('health_history', JSON.stringify(data.history));
                        if (data.settings) {
                            localStorage.setItem('health_settings', JSON.stringify(data.settings));
                        }
                        
                        alert('✅ 数据导入成功！');
                        location.reload();
                        return true;
                    }
                } catch (error) {
                    alert('❌ 数据导入失败：' + error.message);
                    return false;
                }
            }
            
            // 清空所有数据
            clearAllData() {
                if (confirm('⚠️ 此操作不可恢复！确定要清空所有健康数据吗？')) {
                    if (confirm('最后确认：真的要删除吗？')) {
                        localStorage.removeItem('health_user_id');
                        localStorage.removeItem('health_history');
                        localStorage.removeItem('health_settings');
                        localStorage.removeItem('fab_guide_shown');
                        alert('✅ 所有数据已清空');
                        location.reload();
                    }
                }
            }
            
            // 检查并显示仪表板
            checkAndShowDashboard() {
                const history = this.getHistory();
                if (history.length > 0) {
                    // 有历史记录，显示仪表板
                    this.renderDashboard();
                    document.getElementById('healthDashboard').style.display = 'block';
                }
            }
            
            // 渲染仪表板
            renderDashboard() {
                const overallScore = this.calculateOverallScore();
                const trend = this.calculateOverallTrend();
                const stats = this.getStatistics();
                const latest = {
                    sleep: this.getLatestRecord('sleep'),
                    cardiovascular: this.getLatestRecord('cardiovascular'),
                    stress: this.getLatestRecord('stress'),
                    tcm: this.getLatestRecord('tcm')
                };
                
                // 更新综合评分和趋势
                document.getElementById('overallScore').textContent = overallScore;
                
                // 更新趋势显示
                const trendEl = document.getElementById('scoreTrend');
                if (trend.change !== 0) {
                    const arrow = trend.direction === 'up' ? '↑' : '↓';
                    const color = trend.direction === 'up' ? '#7ed321' : '#ff6b35';
                    trendEl.innerHTML = `<i class="fas fa-arrow-${trend.direction === 'up' ? 'up' : 'down'}" style="color: ${color}"></i> <span>较上次 ${trend.change > 0 ? '+' : ''}${trend.change}</span>`;
                    trendEl.style.color = color;
                } else {
                    trendEl.innerHTML = '<span>暂无对比数据</span>';
                    trendEl.style.color = 'rgba(255, 255, 255, 0.8)';
                }
                
                // 更新各项指标
                this.updateMetric('sleep', latest.sleep);
                this.updateMetric('cardiovascular', latest.cardiovascular);
                this.updateMetric('stress', latest.stress);
                this.updateMetric('tcm', latest.tcm);
                
                // 更新统计信息
                document.getElementById('totalTests').textContent = stats.totalTests;
                document.getElementById('lastTestDate').textContent = stats.lastTestDate || '--';
                document.getElementById('completionRate').textContent = stats.completionRate + '%';
                
                // 更新建议
                this.renderRecommendations();
            }
            
            // 更新单项指标
            updateMetric(type, record) {
                const scoreEl = document.getElementById(type + 'Score');
                const barEl = document.getElementById(type + 'Bar');
                
                if (record) {
                    const score = type === 'stress' ? (100 - record.score) : record.score;
                    const previousRecord = this.getPreviousRecord(type);
                    
                    // 显示分数和趋势
                    let scoreHTML = score;
                    if (previousRecord) {
                        const prevScore = type === 'stress' ? (100 - previousRecord.score) : previousRecord.score;
                        const change = score - prevScore;
                        if (change !== 0) {
                            const arrow = change > 0 ? '↑' : '↓';
                            const color = change > 0 ? '#7ed321' : '#ff6b35';
                            scoreHTML += ` <span style="font-size: 14px; color: ${color}">${arrow}${Math.abs(change)}</span>`;
                        }
                    }
                    
                    scoreEl.innerHTML = scoreHTML;
                    barEl.style.width = score + '%';
                } else {
                    scoreEl.textContent = '--';
                    barEl.style.width = '0%';
                }
            }
            
            // 渲染建议
            renderRecommendations() {
                const recommendations = this.generateRecommendations();
                const listEl = document.getElementById('recommendationList');
                
                listEl.innerHTML = recommendations.map(rec => `
                    <div class="recommendation-item">
                        <div class="recommendation-text">${rec}</div>
                    </div>
                `).join('');
            }
            
            // 更新浮动按钮状态
            updateFabState() {
                const fabMain = document.getElementById('fabMain');
                
                // 如果元素还未加载，直接返回
                if (!fabMain) {
                    return;
                }
                
                const history = this.getHistory();
                
                if (history.length > 0) {
                    // 有数据时添加脉冲动画
                    fabMain.classList.add('has-data');
                } else {
                    fabMain.classList.remove('has-data');
                }
            }
        }
        */
        
        // healthDataManager 由 js/health-data-manager.js 自动创建并挂载到 window 对象上
        // 为了兼容性，创建一个引用
        const healthDataManager = window.healthDataManager;

        // ========== UI交互函数 ==========

        // 切换仪表板显示
        function toggleDashboard() {
            const dashboard = document.getElementById('healthDashboard');
            if (dashboard.style.display === 'none') {
                renderDashboard();
                dashboard.style.display = 'block';
                dashboard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
                dashboard.style.display = 'none';
            }
        }

        // 切换FAB菜单
        function toggleFabMenu() {
            const menu = document.getElementById('fabMenu');
            menu.classList.toggle('active');
        }

        // 显示历史记录
        function showHistory() {
            const modal = document.getElementById('historyModal');
            modal.classList.add('active');
            
            // 先更新计数
            updateHistoryCounts();
            
            // 然后渲染时间轴
            renderHistoryTimeline();
            
            // 调试：显示当前数据
            console.log('💾 当前健康数据:', healthDataManager.getHistory());
        }

        // 关闭历史记录弹窗
        function closeHistoryModal(event) {
            if (event && event.target !== event.currentTarget) return;
            const modal = document.getElementById('historyModal');
            modal.classList.remove('active');
        }

        // 渲染历史时间轴
        function renderHistoryTimeline(filterType = 'all') {
            const history = healthDataManager.getHistory();
            const filtered = filterType === 'all' ? history : history.filter(h => h.testType === filterType);
            const timeline = document.getElementById('historyTimeline');
            const empty = document.getElementById('emptyHistory');
            
            console.log('📋 渲染历史记录:', { total: history.length, filtered: filtered.length, filterType });
            
            if (filtered.length === 0) {
                timeline.style.display = 'none';
                empty.style.display = 'block';
                return;
            }
            
            timeline.style.display = 'block';
            empty.style.display = 'none';
            
            // 按时间倒序排列
            const sorted = filtered.sort((a, b) => b.timestamp - a.timestamp);
            
            timeline.innerHTML = sorted.map(record => {
                const icon = {
                    'sleep': '😴',
                    'cardiovascular': '❤️',
                    'stress': '🧠',
                    'tcm': '☯️'
                }[record.testType] || '📊';
                
                // 确保分数显示正确（压力类型转换为健康度）
                let displayScore;
                if (typeof record.score === 'number') {
                    // 压力类型：转换为健康度（100 - 压力分数）
                    displayScore = record.testType === 'stress' ? (100 - record.score) : record.score;
                } else {
                    displayScore = '--';
                }
                const displayLevel = record.level || '未知';
                
                // 调试日志（可选）
                if (record.testType === 'stress') {
                    console.log(`📊 压力测试显示转换: ${record.testName} - 原始=${record.score}, 显示=${displayScore} (健康度)`);
                }
                
                return `
                    <div class="history-item" data-type="${record.testType}">
                        <div class="history-date">
                            ${icon} ${record.date || '日期未知'} ${record.timestamp ? new Date(record.timestamp).toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' }) : ''}
                        </div>
                        <div class="history-title">${record.testName || '测试'}</div>
                        <div class="history-score">${displayScore}${typeof displayScore === 'number' ? '分' : ''}</div>
                        <div class="history-level">${displayLevel}</div>
                    </div>
                `;
            }).join('');
        }

        // 筛选历史记录
        function filterHistory(type) {
            // 更新按钮状态
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.type === type) {
                    btn.classList.add('active');
                }
            });
            
            // 渲染过滤后的记录
            renderHistoryTimeline(type);
        }

        // 更新历史记录计数
        function updateHistoryCounts() {
            const stats = healthDataManager.getStatistics();
            document.getElementById('countAll').textContent = stats.totalTests;
            document.getElementById('countSleep').textContent = stats.sleepCount;
            document.getElementById('countCardiovascular').textContent = stats.cardiovascularCount;
            document.getElementById('countStress').textContent = stats.stressCount;
            document.getElementById('countTcm').textContent = stats.tcmCount;
        }

        // 导出数据
        function exportData() {
            healthDataManager.exportData();
        }

        // 导入数据
        function importData() {
            document.getElementById('importFileInput').click();
        }

        // 处理文件导入
        function handleImportFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                healthDataManager.importData(e.target.result);
            };
            reader.readAsText(file);
        }

        // 显示数据说明
        function showDataInfo() {
            const modal = document.getElementById('dataInfoModal');
            modal.classList.add('active');
            document.getElementById('displayUserId').textContent = healthDataManager.userId;
        }

        // 关闭数据说明弹窗
        function closeDataInfoModal(event) {
            if (event && event.target !== event.currentTarget) return;
            const modal = document.getElementById('dataInfoModal');
            modal.classList.remove('active');
        }

        // 复制用户ID
        function copyUserId() {
            const userId = healthDataManager.userId;
            navigator.clipboard.writeText(userId).then(() => {
                alert('✅ 用户ID已复制到剪贴板');
            });
        }

        // 确认清空数据
        function confirmClearData() {
            healthDataManager.clearAllData();
        }

        // 显示首次引导
        function showFabGuide() {
            // 检查是否已经显示过引导
            if (localStorage.getItem('fab_guide_shown') === 'true') {
                return;
            }
            
            const overlay = document.getElementById('fabGuideOverlay');
            overlay.classList.add('active');
            
            // 记录已显示引导
            localStorage.setItem('fab_guide_shown', 'true');
        }

        // 关闭引导
        function closeFabGuide(event) {
            if (event && event.target !== event.currentTarget) return;
            
            const overlay = document.getElementById('fabGuideOverlay');
            overlay.classList.remove('active');
            
            // 打开仪表板展示数据
            setTimeout(() => {
                toggleDashboard();
            }, 300);
        }

        // 手动触发引导（用于测试）
        function resetFabGuide() {
            localStorage.removeItem('fab_guide_shown');
            showFabGuide();
        }

        // 移动端菜单切换
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('active');
        }

        // 语言切换功能
        function switchLanguage(lang) {
            const elements = document.querySelectorAll('[data-zh], [data-en], [data-tw]');
            const buttons = document.querySelectorAll('.lang-btn');
            
            elements.forEach(element => {
                const text = element.getAttribute(`data-${lang}`);
                if (text) {
                    element.textContent = text;
                }
            });
            
            buttons.forEach(button => {
                button.classList.remove('active');
            });
            
            document.querySelectorAll(`.lang-btn`).forEach(button => {
                if ((lang === 'zh' && button.textContent === '中文') ||
                    (lang === 'en' && button.textContent === 'English')) {
                    button.classList.add('active');
                }
            });
            
            localStorage.setItem('preferred-language', lang);
        }

        // 渲染仪表板
        function renderDashboard() {
            const overallScore = healthDataManager.calculateOverallScore();
            const trend = healthDataManager.calculateOverallTrend();
            const stats = healthDataManager.getStatistics();
            const latest = {
                sleep: healthDataManager.getLatestRecord('sleep'),
                cardiovascular: healthDataManager.getLatestRecord('cardiovascular'),
                stress: healthDataManager.getLatestRecord('stress'),
                tcm: healthDataManager.getLatestRecord('tcm')
            };
            
            // 更新综合评分和趋势
            document.getElementById('overallScore').textContent = overallScore;
            
            // 更新趋势显示
            const trendEl = document.getElementById('scoreTrend');
            if (trend.change !== 0) {
                const arrow = trend.direction === 'up' ? '↑' : '↓';
                const color = trend.direction === 'up' ? '#7ed321' : '#ff6b35';
                trendEl.innerHTML = `<i class="fas fa-arrow-${trend.direction === 'up' ? 'up' : 'down'}" style="color: ${color}"></i> <span>较上次 ${trend.change > 0 ? '+' : ''}${trend.change}</span>`;
                trendEl.style.color = color;
            } else {
                trendEl.innerHTML = '<span>暂无对比数据</span>';
                trendEl.style.color = 'rgba(255, 255, 255, 0.8)';
            }
            
            // 更新各项指标
            updateMetric('sleep', latest.sleep);
            updateMetric('cardiovascular', latest.cardiovascular);
            updateMetric('stress', latest.stress);
            updateMetric('tcm', latest.tcm);
            
            // 更新统计信息
            document.getElementById('totalTests').textContent = stats.totalTests;
            document.getElementById('lastTestDate').textContent = stats.lastTestDate || '--';
            document.getElementById('completionRate').textContent = stats.completionRate + '%';
            
            // 更新建议
            renderRecommendations();
        }
        
        // 更新单项指标
        function updateMetric(type, record) {
            const scoreEl = document.getElementById(type + 'Score');
            const barEl = document.getElementById(type + 'Bar');
            
            if (record) {
                const score = type === 'stress' ? (100 - record.score) : record.score;
                const previousRecord = healthDataManager.getPreviousRecord(type);
                
                // 显示分数和趋势
                let scoreHTML = score;
                if (previousRecord) {
                    const prevScore = type === 'stress' ? (100 - previousRecord.score) : previousRecord.score;
                    const change = score - prevScore;
                    if (change !== 0) {
                        const arrow = change > 0 ? '↑' : '↓';
                        const color = change > 0 ? '#7ed321' : '#ff6b35';
                        scoreHTML += ` <span style="font-size: 14px; color: ${color}">${arrow}${Math.abs(change)}</span>`;
                    }
                }
                
                scoreEl.innerHTML = scoreHTML;
                barEl.style.width = score + '%';
            } else {
                scoreEl.textContent = '--';
                barEl.style.width = '0%';
            }
        }
        
        // 渲染建议
        function renderRecommendations() {
            const recommendations = healthDataManager.generateRecommendations();
            const listEl = document.getElementById('recommendationList');
            
            listEl.innerHTML = recommendations.map(rec => `
                <div class="recommendation-item">
                    <div class="recommendation-text">${rec}</div>
                </div>
            `).join('');
        }
        
        // 检查并自动显示仪表板（如果有数据）
        function checkAndShowDashboard() {
            const history = healthDataManager.getHistory();
            if (history.length > 0) {
                // 有历史记录，显示仪表板
                const dashboard = document.getElementById('healthDashboard');
                if (dashboard) {
                    renderDashboard();
                    dashboard.style.display = 'block';
                }
            }
        }
        
        // 更新浮动按钮状态
        function updateFabState() {
            const fabMain = document.getElementById('fabMain');
            if (!fabMain) return;
            
            const history = healthDataManager.getHistory();
            if (history.length > 0) {
                fabMain.classList.add('has-data');
            } else {
                fabMain.classList.remove('has-data');
            }
        }
        
        // 页面加载时恢复语言设置
        document.addEventListener('DOMContentLoaded', function() {
            const savedLang = localStorage.getItem('preferred-language') || 'zh';
            if (savedLang !== 'zh') {
                switchLanguage(savedLang);
            }
            
            // 检查并显示仪表板（如果有历史数据）
            checkAndShowDashboard();
            
            // 更新浮动按钮状态
            updateFabState();
            
            // 检查URL参数，如果有 showDashboard=true，自动显示仪表盘
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('showDashboard') === 'true') {
                setTimeout(() => {
                    toggleDashboard();
                    // 清除URL参数
                    window.history.replaceState({}, '', 'health-assessment.html');
                }, 500);
            }
        });
    </script>

    <!-- 浮动数据管理按钮 -->
    <div class="floating-actions">
        <div class="fab-label-permanent">我的健康数据</div>
        <button class="fab-main" id="fabMain" onclick="toggleFabMenu()">
            <i class="fas fa-chart-line"></i>
            <div class="fab-tooltip">查看我的健康数据</div>
        </button>
        <div class="fab-menu" id="fabMenu">
            <button class="fab-item" onclick="toggleDashboard()" title="健康仪表板">
                <i class="fas fa-chart-line"></i>
                <span>仪表板</span>
            </button>
            <button class="fab-item" onclick="showHistory()" title="测试历史">
                <i class="fas fa-history"></i>
                <span>历史记录</span>
            </button>
            <button class="fab-item" onclick="exportData()" title="导出数据">
                <i class="fas fa-download"></i>
                <span>导出数据</span>
            </button>
            <button class="fab-item" onclick="importData()" title="导入数据">
                <i class="fas fa-upload"></i>
                <span>导入数据</span>
            </button>
            <button class="fab-item" onclick="showDataInfo()" title="数据说明">
                <i class="fas fa-info-circle"></i>
                <span>数据说明</span>
            </button>
        </div>
    </div>

    <!-- 隐藏的文件上传input -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="handleImportFile(event)">

    <!-- 测试历史弹窗 -->
    <div class="modal-overlay" id="historyModal" onclick="closeHistoryModal(event)">
        <div class="modal-content history-modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-history"></i>
                    测试历史记录
                </h2>
                <button class="modal-close" onclick="closeHistoryModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <!-- 筛选器 -->
                <div class="history-filters">
                    <button class="filter-btn active" data-type="all" onclick="filterHistory('all')">
                        全部 (<span id="countAll">0</span>)
                    </button>
                    <button class="filter-btn" data-type="sleep" onclick="filterHistory('sleep')">
                        😴 睡眠 (<span id="countSleep">0</span>)
                    </button>
                    <button class="filter-btn" data-type="cardiovascular" onclick="filterHistory('cardiovascular')">
                        ❤️ 心血管 (<span id="countCardiovascular">0</span>)
                    </button>
                    <button class="filter-btn" data-type="stress" onclick="filterHistory('stress')">
                        🧠 压力 (<span id="countStress">0</span>)
                    </button>
                    <button class="filter-btn" data-type="tcm" onclick="filterHistory('tcm')">
                        ☯️ 体质 (<span id="countTcm">0</span>)
                    </button>
                </div>
                
                <!-- 时间轴 -->
                <div class="history-timeline" id="historyTimeline">
                    <!-- 动态生成历史记录 -->
                </div>
                
                <!-- 空状态 -->
                <div class="empty-state" id="emptyHistory" style="display: none;">
                    <i class="fas fa-inbox"></i>
                    <p>还没有测试记录</p>
                    <p class="empty-hint">完成测试后，这里会显示您的历史记录</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 数据说明弹窗 -->
    <div class="modal-overlay" id="dataInfoModal" onclick="closeDataInfoModal(event)">
        <div class="modal-content data-info-modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-shield-alt"></i>
                    关于您的数据
                </h2>
                <button class="modal-close" onclick="closeDataInfoModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="info-section">
                    <h3>🔒 数据存储方式</h3>
                    <p>您的所有健康数据存储在<strong>本地浏览器</strong>中（LocalStorage），我们不会上传任何数据到服务器。</p>
                </div>
                
                <div class="info-section">
                    <h3>⚠️ 重要提示</h3>
                    <ul>
                        <li>清空浏览器数据会导致记录丢失</li>
                        <li>更换浏览器或设备无法自动同步</li>
                        <li>建议定期导出备份您的数据</li>
                    </ul>
                </div>
                
                <div class="info-section">
                    <h3>💾 备份与恢复</h3>
                    <p>点击"导出数据"可下载JSON格式的备份文件，在其他设备上点击"导入数据"即可恢复。</p>
                </div>
                
                <div class="info-section">
                    <h3>🔑 您的用户ID</h3>
                    <p class="user-id-display">
                        <code id="displayUserId">--</code>
                        <button class="copy-btn" onclick="copyUserId()">
                            <i class="fas fa-copy"></i> 复制
                        </button>
                    </p>
                    <p class="user-id-hint">保存此ID可用于数据恢复</p>
                </div>
                
                <div class="danger-zone">
                    <h3>🗑️ 危险操作</h3>
                    <button class="btn-danger" onclick="confirmClearData()">
                        <i class="fas fa-trash-alt"></i>
                        清空所有数据
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 首次引导蒙层 -->
    <div class="fab-guide-overlay" id="fabGuideOverlay" onclick="closeFabGuide(event)">
        <div class="fab-highlight-zone"></div>
        <div class="fab-guide-content" onclick="event.stopPropagation()">
            <div class="fab-guide-icon">🎉</div>
            <div class="fab-guide-title">数据已保存成功！</div>
            <div class="fab-guide-desc">
                您的健康测试数据已安全存储在本地。<br>
                点击右下角按钮，随时查看您的健康总览、历史记录和数据管理。
            </div>
            <button class="fab-guide-btn" onclick="closeFabGuide()">知道了</button>
        </div>
        <div class="fab-guide-arrow">👇</div>
    </div>
</body>
</html>
